function getLikeUnloveList(){if("system"==getCookie("loginGroup"))return;items=parseInt($(this).html().match(/\d+/)[0]),items&&(m=this.id,lastlist!=m?(lastlist=m,$("#listArea .title").html(m=="like"?"\u559c\u7231list(\u70b9\u51fb\u559c\u7231\u9891\u9053\uff0c\u53ef\u4ee5\u6536\u542c\u672c\u5217\u8868\u91cc\u7684\u6b4c\u66f2)":"\u4e0d\u518d\u64ad\u653elist(\u5217\u8868\u4e2d\u7684\u6b4c\u66f2\u4e0d\u4f1a\u88ab\u64ad\u653e\uff0c\u5305\u62ec\u559c\u7231\u9891\u9053)"),getListByAjax(m,1),pageDiv.initPageBar(items),$("#listArea").show()):$("#listArea").show())}function getListByAjax(e,t){param={},param.m=e,param.f="get",param.sid=0,param.page=t;var n=$("#listArea table"),r=n.find("tbody");$.ajax({url:"action.php",data:param,dataType:"json",success:function(e){type=typeof e;if(type=="object"){pageDiv.currentPage=t,r.empty();for(var i=0;i<e.length;++i)r.append(listTemplate.replace(/{(\d+)}/g,function(t){switch(t){case"{1}":return e[i].song;case"{2}":return e[i].artist;case"{3}":return e[i].time;case"{4}":return e[i].sid}}));e.length==0&&r.html('<tr><td colspan="4">\u5217\u8868\u4e3a\u7a7a.....</td></tr>'),r.find("a").click(delItem)}else r.html('<tr><td colspan="4">\u670d\u52a1\u5668\u51fa\u9519\u4e86.....</td></tr>'),pageDiv.currentPage=1;n.show(),pageDiv.initPageBar(parseInt($("#"+lastlist).html().match(/\d+/)[0]))},beforeSend:function(e){n.hide(),r.html("\u7a0b\u5e8f\u541b\u6b63\u5728\u52aa\u529b\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u7b49~")},error:function(){n.show(),r.html('<tr><td colspan="4">\u65e0\u6cd5\u52a0\u8f7d\u5217\u8868.....</td></tr>'),pageDiv.currentPage=1}})}function delItem(e){var t=this,n="."+lastlist+"-num";param={},param.m=lastlist,param.f="del",param.sid=$(this).attr("sid"),$.getJSON("action.php",param,function(e){e=="ok"?($(n).html($(n).html().replace(/-?\d+/,function(e){return parseInt(e)-1})),$(t).closest("tr").remove()):$("#adArea").html("\u51fa\u9519\u4e86.....")})}function clickPage(){$(this).html()!=pageDiv.currentPage&&getListByAjax(lastlist,$(this).html())}function setCookie(e,t,n){var r=new Date;r.setDate(r.getDate()+n),document.cookie=e+"="+escape(t)+(n==null?"":";expires="+r.toGMTString())}function getCookie(e){if(document.cookie.length>0){c_start=document.cookie.indexOf(e+"=");if(c_start!=-1)return c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))}return""}var switchbutton=null;$(document).ready(function(){$("#jquery_jplayer_1").jPlayer({swfPath:"js",wmode:"window"}),$.ajaxSetup({error:function(){$("#adArea").html("\u554a\u54a7\uff0c\u597d\u5947\u602a\uff0c\u8bf7\u6c42\u597d\u50cf\u5931\u8d25\u4e86\uff0c\u7a0d\u540e\u518d\u8bd5\uff1f")}}),fm.init(),list.init(),"duowan"==getCookie("group")&&($("body").height(550),$("#main").css({width:"700px",height:"550px"}),$("#container").css({margin:"0px"})),switchbutton=$("a.switch2artist"),$(document).keydown(function(e){if(e.which==38)$("#channelup").click();else if(e.which==40)$("#channeldown").click();else if(e.which==37){if(switchbutton==null)return;switchbutton.attr("id")=="switch2common"&&switchbutton.click()}else if(e.which==39){if(switchbutton==null)return;switchbutton.attr("id")=="switch2artist"&&switchbutton.click()}}),$(document).mouseup(function(e){e.which==2&&switchbutton!=null&&switchbutton.click()}),"sina"!=getCookie("group")&&$(document).mousewheel(function(e,t){t>0?$("#channelup").click():t<0&&$("#channeldown").click()})});var fm={init:function(){fm.bindChannelEvent(),fm.checkLastChannel(newcid,newsid)},bindChannelEvent:function(){$("#channelArea a").click(function(e){if($(this).hasClass("sub-channel-on"))return;var t=this;$("#channelArea a").each(function(){$(this).removeClass(),t==this?($(this).addClass("sub-channel-on"),$(this).siblings(".listened-num").show()):($(this).addClass("sub-channel-off"),$(this).siblings(".listened-num").hide())}),setCookie("cid",$(this).attr("cid"),7),$("#jquery_jplayer_1").jPlayer("getMedia","n",newsid)}),$("a.switch2common").click(function(){if(switchbutton==null)return;switchbutton=null,channelList=$("#channelArea .list"),channelList.show(),channelList.eq(0).animate({"margin-left":"0"},"normal","linear",function(){channelList.eq(1).hide(),switchbutton=$("a.switch2artist")}),$(this).hide(),$("a.switch2artist").show()}),$("a.switch2artist").click(function(){if(switchbutton==null)return;switchbutton=null,channelList=$("#channelArea .list"),channelList.show(),channelList.eq(0).animate({"margin-left":"-220px"},"normal","linear",function(){channelList.eq(0).hide(),switchbutton=$("a.switch2common")}),$(this).hide(),$("a.switch2common").show()}),$(".channel-up").click(function(){cc=$("#channelContainer"),st=cc.scrollTop()-cc.height(),st=st<0?0:st,cc.scrollTop(st)}),$(".channel-down").click(function(){cc=$("#channelContainer"),st=cc.scrollTop()+cc.height(),st=st>cc[0].scrollHeight?cc[0].scrollHeight:st,cc.scrollTop(st)})},checkLastChannel:function(e,t){e?setCookie("cid",e,7):e=getCookie("cid"),e!=""?setTimeout(function(){$("#channelArea a").each(function(){$(this).attr("cid")==e&&($(this).click(),channelid=$(this).closest("ul").attr("id"),channelid=="artist_list"?$(".switch2artist").click():$(".switch2common").click())}),newcid=0,newsid=0},1500):$(".switch2common").click()}},list={init:function(){$(".like-num").click(getLikeUnloveList),$(".unlove-num").click(getLikeUnloveList),pageDiv.bindEvent()}},lastlist="",pageDiv={currentPage:1,itemPerPage:10,totalPage:1,initPageBar:function(e){pageDiv.totalPage=Math.ceil(e/pageDiv.itemPerPage),cp=pageDiv.currentPage,pageDiv.edgePage(),pageDiv.midPage(cp),pageDiv.addCurrentClass()},shiftPageBar:function(){tp=pageDiv.totalPage,tp>7&&(mid=parseInt($("#pagebar a.pages").eq(3).html()),newmid=this.id=="left_arrow"?mid-5:mid+5,pagDiv.midPage(newmid),pageDiv.addCurrentClass())},edgePage:function(){tp=pageDiv.totalPage,$("#first_page").html(1),$("#first_page").show(),tp>1?($("#last_page").show(),$("#last_page").html(tp)):$("#last_page").hide()},midPage:function(e){tp=pageDiv.totalPage,cp<=4?(arr=[2,3,4,5,6],$("#left_suspension").hide(),$("#right_suspension").show()):tp-cp<=3?(arr=[tp-5,tp-4,tp-4,tp-3,tp-2,tp-1],$("#left_suspension").show(),$("#right_suspension").hide()):(arr=[e-2,e-1,e,e+1,e+2],$("#left_suspension").show(),$("#right_suspension").show()),tp<8?($("#left_suspension").hide(),$("#right_suspension").hide(),$("#left_arrow").hide(),$("#right_arrow").hide()):($("#left_arrow").show(),$("#right_arrow").show()),$("#pagebar a.pages").each(function(e){e>0&&e<6&&(pagenum=arr.shift(),pagenum<tp?($(this).html(pagenum),$(this).show()):$(this).hide())})},addCurrentClass:function(){$("#pagebar a.pages").each(function(){$(this).removeClass("current-page"),parseInt($(this).html())==pageDiv.currentPage&&$(this).addClass("current-page")})},bindEvent:function(){$("#left_arrow").click(pageDiv.shiftPageBar),$("#right_arrow").click(pageDiv.shiftPageBar),$("#pagebar a.pages").click(clickPage)}};listTemplate='<tr><td>{1}</td><td>{2}</td><td>{3}</td><td><a href="javascript:;" class="del-button" sid="{4}" hidefocus>\u5220\u9664</a></td></tr>',function(e){typeof define=="function"&&define.amd?define(["jquery"],e):typeof exports=="object"?module.exports=e:e(jQuery)}(function(e){function o(t){var n=t||window.event,s=[].slice.call(arguments,1),o=0,u=0,a=0,f=0,l=0,c;t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(o=n.wheelDelta),n.detail&&(o=n.detail*-1),n.deltaY&&(a=n.deltaY*-1,o=a),n.deltaX&&(u=n.deltaX,o=u*-1),n.wheelDeltaY!==undefined&&(a=n.wheelDeltaY),n.wheelDeltaX!==undefined&&(u=n.wheelDeltaX*-1),f=Math.abs(o);if(!r||f<r)r=f;l=Math.max(Math.abs(a),Math.abs(u));if(!i||l<i)i=l;return c=o>0?"floor":"ceil",o=Math[c](o/r),u=Math[c](u/i),a=Math[c](a/i),s.unshift(t,o,u,a),(e.event.dispatch||e.event.handle).apply(this,s)}var t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],n="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],r,i;if(e.event.fixHooks)for(var s=t.length;s;)e.event.fixHooks[t[--s]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],o,!1);else this.onmousewheel=o},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],o,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});